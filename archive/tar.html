<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head>
        
        <meta charset="UTF-8">
        <title>tar | </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.7.1">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <meta name="author" content="goManual">
    
    
    <link rel="next" href="../archive/zip.html" />
    
    
    <link rel="prev" href="../archive/README.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book" data-github="goManual/goManual" data-level="1.1" data-basepath=".." data-revision="1408456557227">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/goManual/goManual" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" ></a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/goManual" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/goManual/goManual/issues" target="blank" class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/goManual/goManual/edit/master/archive/tar.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

	

        
        <li class="divider"></li>
        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         简介
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="archive/README.html">
            
                
                    <a href="../archive/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         archive
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter active" data-level="1.1" data-path="archive/tar.html">
            
                
                    <a href="../archive/tar.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         tar
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="archive/zip.html">
            
                
                    <a href="../archive/zip.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         zip
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="bufio/README.html">
            
                
                    <a href="../bufio/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         bufio
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 50%;min-width: 25%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="简介" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../archive/README.html" title="archive" class="chapter done new-chapter" data-progress="1" style="left: 25%;"></a>
    
        <a href="../archive/tar.html" title="tar" class="chapter done " data-progress="1.1" style="left: 50%;"></a>
    
        <a href="../archive/zip.html" title="zip" class="chapter  " data-progress="1.2" style="left: 75%;"></a>
    
        <a href="../bufio/README.html" title="bufio" class="chapter  new-chapter" data-progress="2" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_3">
                    
                        <h1 id="package-tar">Package tar</h1>
<p>Package tar implements access to tar archives. It aims to cover most of the variations, including those produced by GNU and BSD tars.<br>
实现访问tar归档文件。它的目的是覆盖大部分变种 ,包含GNU和BSD归档文件。</p>
<p>引用:<br>
<a href="http://www.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=5" target="_blank">http://www.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=5</a><br>
<a href="http://www.gnu.org/software/tar/manual/html_node/Standard.html" target="_blank">http://www.gnu.org/software/tar/manual/html_node/Standard.html</a><br>
<a href="http://pubs.opengroup.org/onlinepubs/9699919799/utilities/pax.html" target="_blank">http://pubs.opengroup.org/onlinepubs/9699919799/utilities/pax.html</a><br></p>
<p>Example:</p>
<pre><code class="lang-golang">  <span class="hljs-comment">// Create a buffer to write our archive to.</span>
  buf := <span class="hljs-built_in">new</span>(bytes.Buffer)

  <span class="hljs-comment">// Create a new tar archive.</span>
  tw := tar.NewWriter(buf)

  <span class="hljs-comment">// Add some files to the archive.</span>
  <span class="hljs-keyword">var</span> files = []<span class="hljs-keyword">struct</span> {
      Name, Body <span class="hljs-typename">string</span>
  }{
      {<span class="hljs-string">"readme.txt"</span>, <span class="hljs-string">"This archive contains some text files."</span>},
      {<span class="hljs-string">"gopher.txt"</span>, <span class="hljs-string">"Gopher names:\nGeorge\nGeoffrey\nGonzo"</span>},
      {<span class="hljs-string">"todo.txt"</span>, <span class="hljs-string">"Get animal handling licence."</span>},
  }
  <span class="hljs-keyword">for</span> _, file := <span class="hljs-keyword">range</span> files {
      hdr := &amp;tar.Header{
          Name: file.Name,
          Size: <span class="hljs-typename">int64</span>(<span class="hljs-built_in">len</span>(file.Body)),
      }
      <span class="hljs-keyword">if</span> err := tw.WriteHeader(hdr); err != <span class="hljs-constant">nil</span> {
          log.Fatalln(err)
      }
      <span class="hljs-keyword">if</span> _, err := tw.Write([]<span class="hljs-typename">byte</span>(file.Body)); err != <span class="hljs-constant">nil</span> {
          log.Fatalln(err)
      }
  }
  <span class="hljs-comment">// Make sure to check the error on Close.</span>
  <span class="hljs-keyword">if</span> err := tw.Close(); err != <span class="hljs-constant">nil</span> {
      log.Fatalln(err)
  }

  <span class="hljs-comment">// Open the tar archive for reading.</span>
  r := bytes.NewReader(buf.Bytes())
  tr := tar.NewReader(r)

  <span class="hljs-comment">// Iterate through the files in the archive.</span>
  <span class="hljs-keyword">for</span> {
      hdr, err := tr.Next()
      <span class="hljs-keyword">if</span> err == io.EOF {
          <span class="hljs-comment">// end of tar archive</span>
          <span class="hljs-keyword">break</span>
      }
      <span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
          log.Fatalln(err)
      }
      fmt.Printf(<span class="hljs-string">"Contents of %s:\n"</span>, hdr.Name)
      <span class="hljs-keyword">if</span> _, err := io.Copy(os.Stdout, tr); err != <span class="hljs-constant">nil</span> {
          log.Fatalln(err)
      }
      fmt.Println()
  }
</code></pre>
<p><br><br></p>
<h3 id="constants">Constants</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">const</span> (

    <span class="hljs-comment">// Types</span>
    TypeReg           = <span class="hljs-string">'0'</span>    <span class="hljs-comment">// regular file</span>
    TypeRegA          = <span class="hljs-string">'\x00'</span> <span class="hljs-comment">// regular file</span>
    TypeLink          = <span class="hljs-string">'1'</span>    <span class="hljs-comment">// hard link</span>
    TypeSymlink       = <span class="hljs-string">'2'</span>    <span class="hljs-comment">// symbolic link</span>
    TypeChar          = <span class="hljs-string">'3'</span>    <span class="hljs-comment">// character device node</span>
    TypeBlock         = <span class="hljs-string">'4'</span>    <span class="hljs-comment">// block device node</span>
    TypeDir           = <span class="hljs-string">'5'</span>    <span class="hljs-comment">// directory</span>
    TypeFifo          = <span class="hljs-string">'6'</span>    <span class="hljs-comment">// fifo node</span>
    TypeCont          = <span class="hljs-string">'7'</span>    <span class="hljs-comment">// reserved</span>
    TypeXHeader       = <span class="hljs-string">'x'</span>    <span class="hljs-comment">// extended header</span>
    TypeXGlobalHeader = <span class="hljs-string">'g'</span>    <span class="hljs-comment">// global extended header</span>
    TypeGNULongName   = <span class="hljs-string">'L'</span>    <span class="hljs-comment">// Next file has a long name</span>
    TypeGNULongLink   = <span class="hljs-string">'K'</span>    <span class="hljs-comment">// Next file symlinks to a file w/ a long name</span>
)
</code></pre>
<p><br><br></p>
<h3 id="variables">Variables</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">var</span> (
    ErrWriteTooLong    = errors.New(<span class="hljs-string">"archive/tar: write too long"</span>)
    ErrFieldTooLong    = errors.New(<span class="hljs-string">"archive/tar: header field too long"</span>)
    ErrWriteAfterClose = errors.New(<span class="hljs-string">"archive/tar: write after close"</span>)
)
</code></pre>
<pre><code class="lang-golang"><span class="hljs-keyword">var</span> (
    ErrHeader = errors.New(<span class="hljs-string">"archive/tar: invalid tar header"</span>)
)
</code></pre>
<p><br><br></p>
<h3 id="type-header">type Header</h3>
<pre><code class="lang-golang">  <span class="hljs-keyword">type</span> Header <span class="hljs-keyword">struct</span> {
          Name       <span class="hljs-typename">string</span>    <span class="hljs-comment">// name of header file entry 头文件名</span>
          Mode       <span class="hljs-typename">int64</span>     <span class="hljs-comment">// permission and mode bits 权限和模式位</span>
          Uid        <span class="hljs-typename">int</span>       <span class="hljs-comment">// user id of owner linux下的Uid</span>
          Gid        <span class="hljs-typename">int</span>       <span class="hljs-comment">// group id of owner 用户组</span>
          Size       <span class="hljs-typename">int64</span>     <span class="hljs-comment">// length in bytes 字节长度</span>
          ModTime    time.Time <span class="hljs-comment">// modified time 修改时间</span>
          Typeflag   <span class="hljs-typename">byte</span>      <span class="hljs-comment">// type of header entry 头文件类型</span>
          Linkname   <span class="hljs-typename">string</span>    <span class="hljs-comment">// target name of link 链接地址</span>
          Uname      <span class="hljs-typename">string</span>    <span class="hljs-comment">// user name of owner 用户名</span>
          Gname      <span class="hljs-typename">string</span>    <span class="hljs-comment">// group name of owner 用户组名</span>
          Devmajor   <span class="hljs-typename">int64</span>     <span class="hljs-comment">// major number of character or block device 大数量的字符或者块设备</span>
          Devminor   <span class="hljs-typename">int64</span>     <span class="hljs-comment">// minor number of character or block device 小数量的字符或者块设备</span>
          AccessTime time.Time <span class="hljs-comment">// access time 访问时间</span>
          ChangeTime time.Time <span class="hljs-comment">// status change time 状态更改时间</span>
  }
</code></pre>
<p>A Header represents a single header in a tar archive. Some fields may not be populated.<br>
Header表示一个tar文档的头信息。 某些字段可以不用填充.
<br><br></p>
<h3 id="func-fileinfoheader">func FileInfoHeader</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> FileInfoHeader(fi os.FileInfo, link <span class="hljs-typename">string</span>) (*Header, error)
</code></pre>
<p>FileInfoHeader creates a partially-populated Header from fi. If fi describes a symlink, FileInfoHeader records link as the link target. If fi describes a directory, a slash is appended to the name. Because os.FileInfo&#39;s Name method returns only the base name of the file it describes, it may be necessary to modify the Name field of the returned header to provide the full path name of the file.<br>
FileInfoHeader 从fi创建部分填充的Header.如果fi是一个符号链接，FileInfoHeader 记录链接的链接目标，如果fi是一个目录，目录名加斜杠。因为os.FileInfo的 Name方法 返回它描述的文件的基本名称，要修改返回头的Name字段必须使用完整的路径名<br>
<br><br></p>
<h3 id="func-h-header-fileinfo">func (h *Header) FileInfo</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> (h *Header) FileInfo() os.FileInfo
</code></pre>
<p>FileInfo returns an os.FileInfo for the Header.<br>
FileInfo 返回一个os.FileInfo
<br><br></p>
<h3 id="type-reader">type Reader</h3>
<pre><code class="lang-golang">  <span class="hljs-keyword">type</span> Reader <span class="hljs-keyword">struct</span> {
          <span class="hljs-comment">// contains filtered or unexported fields 包涵过滤或取消导出字段</span>
  }
</code></pre>
<p>A Reader provides sequential access to the contents of a tar archive. A tar archive consists of a sequence of files. The Next method advances to the next file in the archive (including the first), and then it can be treated as an io.Reader to access the file&#39;s data.<br>
Reader 顺序访问tar归档包的目录。一个tar归档由一系列文件组成。Next方法访问归档文件中的下一个文件（包含第一个文件）然后它可以像io.Reader一样访问文件的数据
<br><br></p>
<h3 id="func-newreader">func NewReader</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> NewReader(r io.Reader) *Reader
</code></pre>
<p>NewReader creates a new Reader reading from r.<br>
NewReader从r中创建新的Reader对象
<br><br></p>
<h3 id="func-tr-reader-next">func (tr *Reader) Next</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> (tr *Reader) Next() (*Header, error)
</code></pre>
<p>Next advances to the next entry in the tar archive<br>
Next 进入的tar归档下一个条目
<br><br></p>
<h3 id="func-tr-reader-read">func (tr *Reader) Read</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> (tr *Reader) Read(b []<span class="hljs-typename">byte</span>) (n <span class="hljs-typename">int</span>, err error)
</code></pre>
<p>Read reads from the current entry in the tar archive. It returns 0, io.EOF when it reaches the end of that entry, until Next is called to advance to the next entry.<br>
Read 从tar归档中读取当前的条目。 当它到该条目末尾时返回0,io.EOF ,直到调用Next前进到下一个条目.
<br><br></p>
<h3 id="type-writer">type Writer</h3>
<pre><code class="lang-golang">  <span class="hljs-keyword">type</span> Writer <span class="hljs-keyword">struct</span> {
        <span class="hljs-comment">// contains filtered or unexported fields</span>
  }
</code></pre>
<p>A Writer provides sequential writing of a tar archive in POSIX.1 format. A tar archive consists of a sequence of files. Call WriteHeader to begin a new file, and then call Write to supply that file&#39;s data, writing at most hdr.Size bytes in total.<br>
Writer 提供用POSIX.1格式顺序写入归档。一个归档文件，由一系列文件组成。调用WriteHeader开始一个新文件，然后调用Write 提供该文件的数据，最多写入hdr.Size字节。
<br><br></p>
<h3 id="func-newwriter">func NewWriter</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> NewWriter(w io.Writer) *Writer
</code></pre>
<p>NewWriter creates a new Writer writing to w.<br>
NewWriter创建一个新的Writer写入w。
<br><br></p>
<h3 id="func-tw-writer-close">func (tw *Writer) Close</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> (tw *Writer) Close() error
</code></pre>
<p>Close closes the tar archive, flushing any unwritten data to the underlying writer.<br>
Close 关闭归档，刷新任何未写入的数据到底层writer
<br><br></p>
<h3 id="func-tw-writer-flush">func (tw *Writer) Flush()</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> (tw *Writer) Flush() error
</code></pre>
<p>Flush finishes writing the current file (optional).<br>
Flush 结束写入当前文件(可选).
<br><br></p>
<h3 id="func-tw-writer-write">func (tw *Writer) Write</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> (tw *Writer) Write(b []<span class="hljs-typename">byte</span>) (n <span class="hljs-typename">int</span>, err error)
</code></pre>
<p>Write writes to the current entry in the tar archive. Write returns the error ErrWriteTooLong if more than hdr.Size bytes are written after WriteHeader.<br>
Write 写入在tar归档中的当前条目. 如果在WriteHeader之后写入的字节超过hdr.Size，Write返回ErrWriteTooLong 错误.
<br><br></p>
<h3 id="func-tw-writer-writeheader">func (tw *Writer) WriteHeader</h3>
<pre><code class="lang-golang"><span class="hljs-keyword">func</span> (tw *Writer) WriteHeader(hdr *Header) error
</code></pre>
<p>WriteHeader writes hdr and prepares to accept the file&#39;s contents. WriteHeader calls Flush if it is not the first header. Calling after a Close will return ErrWriteAfterClose.<br>
WriteHeader写hdr并准备接收文件的内容.如果不是第一个header, WriteHeader调用Flush. 在Close 之后调用该方法将返回ErrWriteAfterClose
<br><br></p>

                    
                    </section>
                
                </div>
            </div>
        </div>

<!--
        
        <a href="../archive/README.html" class="navigation navigation-prev " aria-label="Previous page: archive"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../archive/zip.html" class="navigation navigation-next " aria-label="Next page: zip"><i class="fa fa-angle-right"></i></a>
        
-->

    </div>
</div>

        
<script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="../gitbook/app.js"></script>

<script src="../gitbook/MathJax.js"></script>
<!--
    
    <script src="https://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    
-->


<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
